
<h1> Admin Dashboard </h1><br>

<div class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Most Popular Events</h3>
  </div>
  <div class="panel-body">
      <!-- Table -->
   <table class="table">
     <thead>
       <th>Building</th>
       <th>Room</th>
       <th>Events</th>
       <th colspan="3"></th>
     </thead>

     <tbody>
       <% Room.joins(:events).group("events.room_id, room.id").order("count(events.room_id) desc") do |room| %>
        <tr>
          <td><%= room.building.name %></td>
          <td><%= room.name %></td>
          <td><%= room.events.count %></td>
        </tr>
       <% end %>
     </tbody>

   </table>

  </div>
</div>

<p><%= link_to 'Export Events to CSV', events_csv_path(format: "csv"), class: "btn btn-default" %></p>
<p><%= link_to 'Export Events to PDF', pdf_path(format: "pdf"), class: "btn btn-default" %></p>

<div class="row">
  <div class="well col-md-4">
    <h1>Rooms</h1>

    <table class="table table-striped">
      <thead>
        <tr>
          <th>Name</th>
          <th>Capacity</th>
          <th>Building.name</th>
          <th colspan="3"></th>
        </tr>
      </thead>

      <tbody>
        <% @rooms.each do |room| %>
          <tr>
            <td><%= room.name %></td>
            <td><%= room.capacity %></td>
            <td><%= room.building.name %></td>
            <td><%= link_to 'Show', room %></td>
            <td><%= link_to 'Edit', edit_room_path(room) %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
  <div class="well col-md-4">
    <h1>Events</h1>

    <table class="table table-striped">
      <thead>
        <tr>
          <th>Start time</th>
          <th>Duration</th>
          <th>Description</th>
          <th>Room</th>
          <th colspan="3"></th>
        </tr>
      </thead>

      <tbody>
        <% @events.each do |event| %>
          <tr>
            <td><%= event.start_time %></td>
            <td><%= event.duration %></td>
            <td><%= event.description %></td>
            <td><%= event.room.name %></td>
            <td><%= link_to 'Show', event %></td>
            <td><%= link_to 'Edit', edit_event_path(event) %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
  <div class="well col-md-4">
    <h1>Invitees</h1>

    <table class="table table-striped">
      <thead>
        <tr>
          <th>Event</th>
          <th>User</th>
          <th colspan="3"></th>
        </tr>
      </thead>

      <tbody>
        <% @invitees.each do |invitee| %>
          <tr>
            <td><%= invitee.event_id %></td>
            <td><%= invitee.user_id %></td>
            <td><%= link_to 'Show', invitee %></td>
            <td><%= link_to 'Edit', edit_invitee_path(invitee) %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
